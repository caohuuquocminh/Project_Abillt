<h1>Store Listing</h1>

<%= search_form_for @search do |f| %>
  <div class="field">
      Sort:
      <%= f.sort_fields do |s| %>
        <%= s.sort_select associations: [:operatingsystems] %>
      <% end %>
  </div>
<div class="actions"><%= f.submit "Search" %></div>
<% end %>


<%= search_form_for @search do |f| %>
        <%= f.search_field :name %>
        <%= f.button :submit %>
<% end %>


Sort By: 
<li><%= link_to "All Products", store_path %></li>

 <h2> <strong> <%= @name %> </strong></h2>


 <h2> <strong> Blind German </strong></h2>

 <table id="products">
  <tr>
    <li><%= sort_link @search, :name, "Product Name" %></li>
    <li><%= sort_link @search, :price, "Price" %></li>    
    <li><%= sort_link @search, :average, "Average Review" %></li>
    <li><%= sort_link @search, :total, "Total Review" %></li>
  </tr>
  </table>
  <br></br>

<div class="row">
  <% @products.each do |product| %>
    <div class="col-md-2 col-sm-2">
    <div class="team-member">
      <div class="thumnail">
        <%= image_tag product.app_img.url(:app_index) %></a>
      </div>
      <p><%= link_to product.name, app_path(product) %></p>
      <p> 
        <% product.operatingsystems.each do |operation| %>
          <li><%= operation.name %></li>
        <% end %>
      </ul>
      </p>
      <p> 
        <% product.languages.each do |lang| %>
          <li><%= lang.name %></li>
        <% end %>
      </ul>
      </p>
      <p class="app-name"><%= number_to_currency(product.price) %></p>
      <div class="average-review-rating" data-score=<%= product.reviews.average(:rating) %>></div>
    </div><br></br>
  </div>
  <% end %>
</div>

  <script>
  $('.average-review-rating').raty({
    readOnly: true,
    path: '/assets/',
    score: function() {
      return $(this).attr('data-score')
    }
  });
</script>


